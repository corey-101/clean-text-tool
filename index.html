<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud Code Cleaner v2.0</title>
    <style>
        /* æ ·å¼ä¿æŒä¸å˜ï¼Œä¸ºäº†èŠ‚çœç¯‡å¹…æˆ‘åªåˆ—å‡ºæ ¸å¿ƒæ”¹åŠ¨ï¼Œä½ å¯ä»¥ç›´æ¥å…¨é€‰è¦†ç›– */
        :root { --bg-color: #1e1e1e; --text-color: #d4d4d4; --input-bg: #252526; --border-color: #3e3e42; --accent-color: #007acc; }
        body { background-color: var(--bg-color); color: var(--text-color); font-family: 'Segoe UI', sans-serif; margin: 0; padding: 20px; display: flex; flex-direction: column; height: 100vh; box-sizing: border-box; }
        h1 { font-size: 1.2rem; color: #fff; text-align: center; margin-bottom: 15px; }
        .container { display: flex; flex-direction: column; gap: 15px; flex: 1; }
        textarea { width: 100%; flex: 1; background-color: var(--input-bg); color: var(--text-color); border: 1px solid var(--border-color); border-radius: 6px; padding: 15px; font-family: 'Consolas', monospace; font-size: 14px; resize: none; outline: none; }
        textarea:focus { border-color: var(--accent-color); }
        .controls { display: flex; gap: 10px; }
        button { flex: 1; padding: 12px; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; color: white; transition: background 0.2s; }
        #btn-copy { background-color: var(--accent-color); }
        #btn-copy:hover { background-color: #005f9e; }
        #btn-clear { background-color: #444; flex: 0 0 80px; }
        #btn-clear:hover { background-color: #555; }
        .status { text-align: center; font-size: 0.9rem; height: 20px; color: #4ec9b0; margin-top: 5px;}
        @media (min-width: 768px) { .container { flex-direction: row; } }
    </style>
</head>
<body>

    <h1>ğŸ“‹ Cloud Code æ ¼å¼æ¸…æ´—å·¥å…· (ä¿®å¤ç‰ˆ)</h1>
    
    <div class="container">
        <textarea id="input" placeholder="ç²˜è´´ CLI è¾“å‡ºæ–‡æœ¬..."></textarea>
        <textarea id="output" placeholder="ç»“æœ..." readonly></textarea>
    </div>

    <div class="status" id="status-msg"></div>

    <div class="controls">
        <button id="btn-clear">æ¸…ç©º</button>
        <button id="btn-copy">å¤åˆ¶ç»“æœ</button>
    </div>

    <script>
        const input = document.getElementById('input');
        const output = document.getElementById('output');
        const btnCopy = document.getElementById('btn-copy');
        const btnClear = document.getElementById('btn-clear');
        const statusMsg = document.getElementById('status-msg');

        function cleanText(text) {
            if (!text) return '';

            // ----------------------------------------------------
            // æ ¸å¿ƒä¿®æ­£åŒºï¼šStrict Regex Logic
            // ----------------------------------------------------
            
            // æ—§ç‰ˆé”™è¯¯é€»è¾‘ï¼š\s+ åƒæ‰äº†æ¢è¡Œç¬¦
            // text.replace(/(?<=\S)\n\s+(?=[^-\d*â€¢])/g, ' ');

            // âœ… æ–°ç‰ˆæ­£ç¡®é€»è¾‘ï¼š
            // 1. ([^\n])      -> æ•è·ä¸Šä¸€è¡Œçš„æœ€åä¸€ä¸ªå­—ï¼ˆç¡®ä¿ä¸æ˜¯ç©ºè¡Œï¼‰
            // 2. \n           -> åŒ¹é…æ¢è¡Œç¬¦
            // 3. [ \t]+       -> ä»…åŒ¹é…æ°´å¹³ç©ºç™½ï¼ˆç©ºæ ¼/Tabï¼‰ï¼Œä¸¥ç¦åŒ¹é… \n
            // 4. (?=[^-\d*â€¢]) -> ç¡®ä¿ä¸‹ä¸€è¡Œä¸æ˜¯åˆ—è¡¨ç¬¦å·
            
            let cleaned = text.replace(/([^\n])\n[ \t]+(?=[^-\d*â€¢])/g, '$1 ');

            // ----------------------------------------------------

            // å»é™¤é¦–å°¾å¤šä½™ç©ºç™½ï¼ˆè§£å†³ç¬¬ä¸€è¡Œç¼©è¿›é—®é¢˜ï¼‰
            cleaned = cleaned.trim();

            // å‹ç¼©å¥ä¸­å¯èƒ½å‡ºç°çš„å¤šä½™ç©ºæ ¼
            cleaned = cleaned.replace(/ +/g, ' ');
            
            // å¯é€‰ï¼šå¦‚æœåˆ—è¡¨é¡¹è¢«å‹ç¼©å¤ªç´§ï¼Œå¯ä»¥åœ¨è¿™é‡ŒæŠŠåˆ—è¡¨é¡¹å‰çš„æ¢è¡Œæ‰¾å›æ¥
            // (é€šå¸¸ä¸Šé¢çš„æ­£åˆ™å·²ç»ä¿æŠ¤äº†åˆ—è¡¨ï¼Œè¿™æ­¥æ˜¯åŒé‡ä¿é™©)
            // cleaned = cleaned.replace(/(\S)\s+(- )/g, '$1\n$2');

            return cleaned;
        }

        input.addEventListener('input', () => {
            output.value = cleanText(input.value);
        });

        btnCopy.addEventListener('click', async () => {
            if (!output.value) return;
            try {
                await navigator.clipboard.writeText(output.value);
                showStatus('âœ… å·²å¤åˆ¶ï¼');
            } catch (err) {
                showStatus('âŒ å¤åˆ¶å¤±è´¥');
            }
        });

        btnClear.addEventListener('click', () => {
            input.value = '';
            output.value = '';
            input.focus();
            showStatus('');
        });

        function showStatus(msg) {
            statusMsg.textContent = msg;
            setTimeout(() => statusMsg.textContent = '', 2000);
        }
    </script>
</body>
</html>
